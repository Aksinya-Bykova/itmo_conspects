## –õ–µ–∫—Ü–∏—è 4. GRASP

GRASP (General Responsibility Assignment Software Principles) -  –æ–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –ü–û

GRASP –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –º—ã—Å–ª—è—Ö –∏–∑ SOLID, –≤ –Ω–µ–≥–æ –≤—Ö–æ–¥—è—Ç 9 –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤

### Informational expert - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–∫—Å–ø–µ—Ä—Ç

> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –æ—Ç–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è —Ç–∞–º, –≥–¥–µ –æ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è

–ü—Ä–∏–≤–µ–¥–µ–º –ø—Ä–∏–º–µ—Ä –∑–∞–∫–∞–∑–∞ –∏ —Å–æ–∑–¥–∞—Ç–µ–ª—è —á–µ–∫–∞:

```csharp
public record OrderItem(
    int Id,
    decimal Price,
    int Quantity);
public class Order
{
    private readonly List<OrderItem> _items;
    public Order()
    {
        _items = new List<OrderItem>();
    }
    public IReadOnlyCollection<OrderItem> Items => _items;
}
public record Receipt(
    decimal TotalCost,
    DateTime Timestamp);
public class ReceiptService
{
    public Receipt CalculateReceipt(Order customer)
    {
        var totalCost = customer.Items
            .Sum(order => order.Price * order.Quantity);
        var timestamp = DateTime.Now;
        return new Receipt(totalCost, timestamp);
    }
}
```

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–∏ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —á–µ–∫–∞ –º—ã –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫–∞–∑–∞ - `order => order.Price * order.Quantity`

–ü–æ—á–µ–º—É –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä—Ç–∞:

* —ç—Ç–æ –Ω–∞—Ä—É—à–µ–Ω–∏–µ SRP 
* –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º: –ª–∏–±–æ –º–Ω–æ–≥–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–≥–æ –∫–æ–¥–∞, –ª–∏–±–æ –Ω–µ–ª–æ–≥–∏—á–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏
* —É—Å–ª–æ–∂–Ω—ë–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø—Ä–∞–≤–∏–º –ø—Ä–∏–º–µ—Ä:

```csharp
public record OrderItem(
    int Id,
    decimal Price,
    int Quantity)
{
    public decimal Cost => Price * Quantity;
}
public class Order
{
    private readonly List<OrderItem> _items;
    public Order()
    {
        _items = new List<OrderItem>();
    }
    public IReadOnlyCollection<OrderItem> Items => _items;
    public decimal TotalCost => _items.Sum(x => x.Cost);
}

public record Receipt(
    decimal TotalCost,
    DateTime Timestamp);
    
public class ReceiptService
{
    public Receipt CalculateReceipt(Order customer)
    {
        var totalCost = customer.TotalCost;
        var timestamp = DateTime.Now;
        return new Receipt(totalCost, timestamp);
    }
}
```

–ó–¥–µ—Å—å –æ–±—ä–µ–∫—Ç –∑–∞–∫–∞–∑–∞ —Å–∞–º –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞ - –Ω–∞ –Ω–µ–º –ª–µ–∂–∏—Ç —ç—Ç–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

### Creator - –°–æ–∑–¥–∞—Ç–µ–ª—å

> –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–æ–ª–∂–Ω–∞ –ª–µ–∂–∞—Ç—å –Ω–∞ —Ç–∏–ø–∞—Ö, –∏—Ö –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö

–ü—Ä–∏–≤–µ–¥–µ–º –ø—Ä–∏–º–µ—Ä: –∑–¥–µ—Å—å —Å–µ—Ä–≤–∏—Å –∑–∞–∫–∞–∑–∞ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∑–∞–∫–∞–∑–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –æ–±—ä–µ–∫—Ç –∑–∞–∫–∞–∑–∞

```csharp
public class Order
{
    private readonly List<OrderItem> _items;

    public Order AddItem(OrderItem item)
    {
        _items.Add(item);
        return this;
    }
}

public class OrderService
{
    public Order CreateDefaultOrder()
    {
        var order = new Order()
            .AddItem(new OrderItem(1, 100, 1))
            .AddItem(new OrderItem(2, 1000, 3));
        return order;
    }
}
```

–ú–æ–∂–Ω–æ —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–∞–∫: –ø–µ—Ä–µ–¥–∞–¥–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫–∞–∑–∞, —á—Ç–æ–±—ã –≤ –æ–±—ä–µ–∫—Ç–µ –∑–∞–∫–∞–∑–∞ –æ–Ω —Å–æ–∑–¥–∞–≤–∞–ª—Å—è

```csharp
public class Order
{
    private readonly List<OrderItem> _items;
    public Order AddItem(
        int id,
        decimal price,
        int quantity)
    {
        _items.Add(new OrderItem(id, price, quantity));
        return this;
    }
}
public class OrderService
{
    public Order CreateDefaultOrder()
    {
    var order = new Order()
        .AddItem(1, 100, 1)
        .AddItem(2, 1000, 3);
    return order;
    }
}
```

–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ Creator:

* –ü–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–µ—è–≤–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º –∏ –º–µ—Ç–æ–¥–æ–º —Å–æ–∑–¥–∞–Ω–∏—è: –µ—Å–ª–∏ –º—ã –∑–∞—Ö–æ—Ç–∏–º –≤ OrderItem –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –±—É–¥–µ—Ç –±–æ–ª—å–Ω–æ –≤–µ–∑–¥–µ –∏–∑–º–µ–Ω—è—Ç—å
* –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ–±–ª–∞–¥–∞–Ω–∏—è –≤—Å–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–∞—Ä—É—à–µ–Ω–∏—é SRP —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º
* –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–ª–æ—Ö–æ –≤–ª–∏—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### Controller - –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä

–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä - –ø–µ—Ä–µ—Ö–æ–¥–Ω–∏–∫ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –∏ –º–æ–¥–µ–ª—è–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. 

–†–∞–∑–ª–∏—á–∞—é—Ç 3 –≤–∏–¥–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤:
   
1. Use-case Controller - –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –æ–¥–∏–Ω –º–µ—Ç–æ–¥ (—á–∞—â–µ –≤—Å–µ–≥–æ –º–∞–ª–æ –∏ –Ω–µ—É–¥–æ–±–Ω–æ)

2. Use-case Group Controller - –∏–Ω–∫–∞–ø—Å—É—Ä–∏—Ä—É–µ—Ç –≥—Ä—É–ø–ø—É –º–µ—Ç–æ–¥–æ–≤ –∏–∑ –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞

3. Facade Controller - –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –Ω–∞–±–æ—Ä –º–µ—Ç–æ–¥–æ–≤ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ (—á–∞—â–µ –≤—Å–µ–≥–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ)

### Low coupling - –°–ª–∞–±–æ–µ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ

> Coupling (–∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ) - –º–µ—Ä–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π –¥—Ä—É–≥ –º–µ–∂–¥—É –¥—Ä—É–≥–æ–º

–°–∏–ª—å–Ω–æ–µ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ (High coupling) - —ç—Ç–æ –ø–ª–æ—Ö–æ

–ù–∞–ø—Ä–∏–º–µ—Ä: –µ—Å—Ç—å –∫–ª–∞—Å—Å `DataProvider`, –º–µ—Ç–æ–¥—ã –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–≤–æ–¥—è—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –º–µ—Å—Ç–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞ –ø–∞–º—è—Ç—å. –õ–æ–≥–∏—á–µ—Å–∫–∏ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–≤—è–∑–∞–Ω—ã, –ø–æ—ç—Ç–æ–º—É –ª—É—á—à–µ –≤—Å–µ–≥–æ –æ—Å–ª–∞–±–∏—Ç—å –∏—Ö –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ - —Å–æ–∑–¥–∞—Ç—å 2 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –¥–ª—è –≤—ã–≤–æ–¥–∞ –ø–∞–º—è—Ç–∏

### High cohesion - –°–∏–ª—å–Ω–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å

> Cohesion (—Å–≤—è–∑–Ω–æ—Å—Ç—å) - –º–µ—Ä–∞ –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–æ–æ—Ç–Ω–µ—Å–µ–Ω–Ω–æ—Å—Ç–∏ –ª–æ–≥–∏–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –º–æ–¥—É–ª—è

–°–ª–∞–±–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å (Low cohesion) - —ç—Ç–æ –ø–ª–æ—Ö–æ

–ü—Ä–∏–º–µ—Ä: —Å–¥–µ–ª–∞–µ–º –∫–ª–∞—Å—Å `DataMonitor`, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω—É–∂–Ω—É—é –º–µ—Ç—Ä–∏–∫—É –æ—Ç `DataProvider` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ `enum MetricType`; —Ç–∞–∫ –∫–∞–∫ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º —Å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º, —Ç–æ –Ω–µ –∏–∑–±–µ–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `switch`, –∞ –∑–Ω–∞—á–∏—Ç –∫–æ–¥ –±—É–¥–µ—Ç —Ç—Ä—É–¥–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å - –Ω–∞—Ä—É—à–∞–µ—Ç—Å—è OCP. 

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å–æ–∑–¥–∞–¥–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è `DataProvider`, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ `DataMonitor`

### Indirection - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

> Object Indirection (–û–±—ä–µ–∫—Ç–Ω–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ) - –ª—é–±–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏, –ø–æ–≤–µ–¥–µ–Ω–∏—è–º–∏, –º–æ–¥—É–ª—è–º–∏, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é, –∞ —á–µ—Ä–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–π –∏—Ö –æ–±—ä–µ–∫—Ç

> Interface Segregetion (–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞) - –ª—é–±–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏, –ø–æ–≤–µ–¥–µ–Ω–∏—è–º–∏, –º–æ–¥—É–ª—è–º–∏, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é, –∞ —á–µ—Ä–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
 
–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω–æ —Å ISP –∏ DIP. –ü—Ä–∏–Ω—Ü–∏–ø –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Model-View-Controller: –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏–∑ Model –æ–±—â–∞–µ—Ç—Å—è —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è View —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä Controller

### Polymorphism - –ü–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º

–ø—É-–ø—É-–ø—Éü¶Ü

![–∫—Ä—è](images/oopcsharp_2024_09_28_1.png)

### Protected variations - –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º

Protected variations –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –æ –ø–æ–∏—Å–∫–µ —É—Å–ª–æ–≤–∏–π, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç –æ–±—ä–µ–∫—Ç–∞ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è; –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–æ–∫—Ä—ã—Ç–∏–µ –∏ –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª—è–º —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### Pure fabrication - –ß–∏—Å—Ç–∞—è –≤—ã–¥—É–º–∫–∞

Pure fabrication (–ß–∏—Å—Ç–∞—è –≤—ã–¥—É–º–∫–∞) –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –≤—ã–¥—É–º–∞–Ω–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏. –ß–∞—â–µ –≤—Å–µ–≥–æ —ç—Ç–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –º–æ–¥—É–ª–∏ (–ª–æ–≥–≥–µ—Ä, –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —Ç.–¥.). –¢–∞–∫–∏–µ —Ç–∏–ø—ã –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–Ω–æ—Å–∏—Ç—å –≤ –¥–æ–º–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å

